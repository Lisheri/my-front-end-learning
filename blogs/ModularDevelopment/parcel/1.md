---
title: parcel学习
date: 2021-05-18
tags:
 - 模块化
 - parcel 
categories: 
 - 前端工程化
---

# Parcl(零配置的前端应用打包器)

提供了近乎傻瓜式的使用体验, 只需要使用他提供的几个简单的命令, 就可以构建前端程序

## 快速上手

老规矩, 直接建一个新项目， 然后`yarn init`

然后需要安装parcel, parcel的模块叫做`parcel-bundler`

安装完过后, 在node_modules中的bin目录下就有了parcel的cli程序

我们需要一个打包入口, 虽然他什么文件都可以作为打包入口, 不过parcel的官方目录还是推荐我们使用html文件作为入口

官方给的理由是: `html是运行在浏览器端的入口, 所以应该使用html文件`

在html中引入的资源, 最终都会被parcel打包到一起, 最终放到输出目录中

同时他也支持`ES Module`

执行命令`yarn parcel src/index.html`

就会发现, 它不仅仅打包了应用, 还开启了开发服务器, 并且自己打开了`Source Map`

这个开发服务器, 还支持自动刷新

## 模块热替换

如果需要模块热更新(替换), 他同样支持, 需要判断是否存在`module.hot`

```javaScript
if (module.hot) {
    module.hot.accept(() => {
        // 这里就可以处理模块热替换的逻辑了
    })
}
```

这里的accept和webpack中的有一点不同, webpack提供了两个参数(模块路径, 处理回调函数), 用于去处理指定模块更新后的逻辑, 但是parcel提供的函数, 只提供了一个参数, 用于处理当当前模块更新或者当前模块所依赖的模块更新过后, 他会自动执行


## 自动安装依赖

除了热替换, 他还支持自动安装依赖, 比如正在开发过程中, 如果你需要第三方依赖, 那么就要先停止, 然后安装， 在启动

但是他可以自动安装依赖

只需要自动导入就可以了, 然后在正常使用, 然后他重新打包后, 就会自动下载依赖

## 加载其他类型资源模块

在parcel中加载任意类型的模块, 都是零配置的, 比如`css文件, 图片等`

直接用就可以了, 不需要停下来做任何事情

## 拆分代码

parcel给开发者的体验, 就是你想做什么, 就去做

同时他也支持动态导入, 并且同样会自动拆分代码

## 总结

使用上没有任何难度， 从命令开启后, 所有的一切， parcel都帮我们完成了

生产打包只需要这样: `yarn parcel build src/index.html`就可以生产打包了

对于相同体量的项目打包, 他比webpack快很多, 因为它内部自动使用的是多进程同时工作, 充分发挥了多核cpu性能

当然webpack中可以使用一个叫做`happypack`的工具开启多进程打包

## 生产包文件

对于生产包的文件, 代码都会被压缩, 同时样式文件也都被单独提取出来了

## parcel体验总结

整体体验的感觉————及其舒适，使用上真的太简单了

parcel中其实也有插件， 但是他自己给我们安装了，所以给人一种很爽的感觉

他是2017年发的， 主要就是webpack配置太过繁琐

核心特点：`完全零配置, 构建速度快，对项目零侵入`

## 但实际上目前大多数打包还是会使用webpack，有两点:

+ webpack生态好，扩展丰富
+ 随着这几年的发展，也越来越好用, 同时越用越熟练

了解parcel主要是为了扩展自己对技术的敏感度
