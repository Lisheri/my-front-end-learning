(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{596:function(s,t,n){s.exports=n.p+"assets/img/2.71cd76f3.jpg"},597:function(s,t,n){s.exports=n.p+"assets/img/3.84ea92e4.jpg"},598:function(s,t,n){s.exports=n.p+"assets/img/4.dc1e0c17.png"},797:function(s,t,n){"use strict";n.r(t);var a=n(5),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"vue3ç»„ä»¶æ¸²æŸ“-å®Œæ•´çš„dom-diff-æµç¨‹-ä¸€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue3ç»„ä»¶æ¸²æŸ“-å®Œæ•´çš„dom-diff-æµç¨‹-ä¸€"}},[s._v("#")]),s._v(" Vue3ç»„ä»¶æ¸²æŸ“ - å®Œæ•´çš„DOM Diff æµç¨‹(ä¸€)")]),s._v(" "),a("ul",[a("li",[s._v("Vueç»„ä»¶çš„æ¸²æŸ“æµç¨‹, æœ¬è´¨ä¸Šå°±æ˜¯æŠŠå„ç§ç±»å‹çš„vnodeæ¸²æŸ“ä¸ºçœŸå®DOM")]),s._v(" "),a("li",[s._v("ç»„ä»¶æ˜¯ç”±æ¨¡æ¿ã€ç»„ä»¶æè¿°å¯¹è±¡å’Œæ•°æ®æ„æˆçš„, æ•°æ®çš„å˜åŒ–ä¼šå½±å“ç»„ä»¶çš„å˜åŒ–\n"),a("ul",[a("li",[s._v("ç»„ä»¶çš„æ¸²æŸ“è¿‡ç¨‹ä¸­åˆ›å»ºäº†ä¸€ä¸ªå¸¦å‰¯ä½œç”¨çš„æ¸²æŸ“å‡½æ•°")]),s._v(" "),a("li",[s._v("å½“æ•°æ®å˜åŒ–çš„æ—¶å€™å°±ä¼šæ‰§è¡Œè¿™ä¸ªæ¸²æŸ“å‡½æ•°æ¥è§¦å‘ç»„ä»¶æ›´æ–°")])])])]),s._v(" "),a("h2",{attrs:{id:"å¸¦å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•°æ›´æ–°ç»„ä»¶çš„è¿‡ç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¸¦å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•°æ›´æ–°ç»„ä»¶çš„è¿‡ç¨‹"}},[s._v("#")]),s._v(" å¸¦å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•°æ›´æ–°ç»„ä»¶çš„è¿‡ç¨‹")]),s._v(" "),a("p",[s._v("ä»¥ä¸‹æ˜¯å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•° setupRenderEffect çš„å®ç°")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" setupRenderEffect"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("SetupRenderEffectFn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    initialVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    optimized\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// create reactive effect for rendering")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºå“åº”å¼çš„å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•°")]),s._v("\n    instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("update "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("componentEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("isMounted"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºç»„ä»¶")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°ç»„ä»¶")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// updateComponent")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// This is triggered by mutation of component's own state (next: null)")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// OR parent calling processComponent (next: VNode)")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" u"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vnode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" instance\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" originNext "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" next\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" vnodeHook"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNodeHook "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("undefined")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pushWarningContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// nextè¡¨ç¤ºæ–°çš„ç»„ä»¶VNode")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¿™é‡Œå…ˆåˆ¤æ–­æ–°çš„ç»„ä»¶å®ä¾‹ä¸­æ˜¯å¦æœ‰æ–°çš„ç»„ä»¶VNode(è¿™é‡Œè®¾è®¡ä¸€ä¸ªç»„ä»¶æ›´æ–°çš„é€»è¾‘, ç¨åä¼šè¯´, è¿™ä¹Ÿæ˜¯éœ€è¦åˆ¤æ–­çš„åŸå› )")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æœ‰åˆ™æ›´æ–°ç»„ä»¶VNode")]),s._v("\n          next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateComponentPreRender")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" optimized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ²¡æœ‰åˆ™nextæŒ‡å‘ä¹‹å‰çš„ç»„ä»¶VNode")]),s._v("\n          next "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vnode\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// beforeUpdate hook")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invokeArrayFns")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// onVnodeBeforeUpdate")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vnodeHook "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("onVnodeBeforeUpdate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invokeVNodeHook")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vnodeHook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// render")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("startMeasure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("render")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¸²æŸ“æ–°çš„å­æ ‘vnode")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" nextTree "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("renderComponentRoot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("endMeasure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("render")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç¼“å­˜æ—§çš„å­æ ‘vnode")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" prevTree "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subTree\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°å­æ ‘vnode")]),s._v("\n        instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subTree "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nextTree\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("startMeasure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("patch")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç»„ä»¶æ›´æ–°æ ¸å¿ƒé€»è¾‘, æ ¹æ®æ–°æ—§å­æ ‘vnodeåšpatch")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n          prevTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          nextTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// parent may have changed if it's in a teleport")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¦‚æœåœ¨teleportç»„ä»¶ä¸­çˆ¶èŠ‚ç‚¹å¯èƒ½å·²ç»æ”¹å˜, æ‰€ä»¥å®¹å™¨ç›´æ¥æ‰¾æ—§æ ‘DOMå…ƒç´ çš„çˆ¶èŠ‚ç‚¹")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostParentNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prevTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// anchor may have changed if it's in a fragment")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‚è€ƒèŠ‚ç‚¹(é”šç‚¹)åœ¨fragmentçš„æƒ…å†µå¯èƒ½æ”¹å˜, æ‰€ä»¥ç›´æ¥æ‰¾æ—§æ ‘DOMå…ƒç´ çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getNextHostNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prevTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          isSVG\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("endMeasure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("patch")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç¼“å­˜æ›´æ–°åçš„DOMèŠ‚ç‚¹")]),s._v("\n        next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nextTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("originNext "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// self-triggered update. In case of HOC, update parent component")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vnode el. HOC is indicated by parent instance's subTree pointing")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// to child component's vnode")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateHOCHostEl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nextTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// updated hook")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("queuePostRenderEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("u"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// onVnodeUpdated")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vnodeHook "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("onVnodeUpdated"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("queuePostRenderEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invokeVNodeHook")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vnodeHook"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" __FEATURE_PROD_DEVTOOLS__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("devtoolsComponentUpdated")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("popWarningContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __DEV__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("createDevEffectOptions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" prodEffectOptions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br")])]),a("p",[s._v("å¯ä»¥çœ‹åˆ°æ›´æ–°ç»„ä»¶ä¸»è¦åšä¸‰ä»¶äº‹æƒ…:")]),s._v(" "),a("ol",[a("li",[s._v("æ›´æ–°ç»„ä»¶VNodeèŠ‚ç‚¹")])]),s._v(" "),a("ul",[a("li",[s._v("è¿™é‡Œä¼šæœ‰ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­, åˆ¤æ–­æ–°çš„ç»„ä»¶å®ä¾‹ä¸­æ˜¯å¦ä¼šæœ‰æ–°çš„ç»„ä»¶VNode, ç”¨ next è¡¨ç¤º")]),s._v(" "),a("li",[s._v("æœ‰åˆ™æ›´æ–°ç»„ä»¶VNode")]),s._v(" "),a("li",[s._v("æ²¡æœ‰åˆ™nextæŒ‡å‘ä¹‹å‰çš„ç»„ä»¶VNode")]),s._v(" "),a("li",[s._v("å…³äºéœ€è¦æ¡ä»¶åˆ¤æ–­çš„åŸå› , è¿™é‡Œæ¶‰åŠä¸€ä¸ªç»„ä»¶æ›´æ–°ç­–ç•¥çš„é€»è¾‘, åç»­ç»†ğŸ”")])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("æ¸²æŸ“æ–°å­æ ‘vnode(subTree)")])]),s._v(" "),a("ul",[a("li",[s._v("å› ä¸ºæ¸²æŸ“å‘ç”Ÿäº†å˜åŒ–, æ¨¡æ¿ä¹Ÿå’Œæ•°æ®ç›¸å…³, æ‰€ä»¥æ¸²æŸ“ç”Ÿæˆçš„å­æ ‘vnodeä¹Ÿä¼šå‘ç”Ÿç›¸åº”çš„å˜åŒ–")]),s._v(" "),a("li",[s._v("è°ƒç”¨ renderComponentRoot æ¸²æŸ“æ–°çš„å­æ ‘vnode")]),s._v(" "),a("li",[s._v("ç„¶åç¼“å­˜æ—§çš„å­æ ‘vndoe")]),s._v(" "),a("li",[s._v("ç¼“å­˜å®Œæ¯•å, å°†æ–°çš„å­æ ‘vnodeæŒ‡å‘ instance.subTree, æ›´æ–°å­æ ‘vnode")])]),s._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[s._v("æ ¹æ®æ–°æ—§å­æ ‘VNodeæ‰§è¡Œ"),a("RouterLink",{attrs:{to:"/blogs/vue3-resource/core/4.html#patchæ›´æ–°é€»è¾‘"}},[s._v("patch")]),s._v("é€»è¾‘")],1)]),s._v(" "),a("ul",[a("li",[s._v("ç»„ä»¶æ›´æ–°çš„æ ¸å¿ƒé€»è¾‘")]),s._v(" "),a("li",[s._v("ç”¨æ¥æ‰¾å‡ºå­æ ‘vnodeçš„ä¸åŒ, å¹¶æ‰¾å‡ºä¸€ç§åˆé€‚çš„æ–¹å¼æ›´æ–°dom")])]),s._v(" "),a("h2",{attrs:{id:"patchæ›´æ–°é€»è¾‘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#patchæ›´æ–°é€»è¾‘"}},[s._v("#")]),s._v(" patchæ›´æ–°é€»è¾‘")]),s._v(" "),a("p",[s._v("æ ¹æ®patchçš„é€»è¾‘å¯ä»¥çœ‹åˆ°")]),s._v(" "),a("ol",[a("li",[s._v("é¦–å…ˆåˆ¤æ–­æ–°æ—§èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ä¸”æ˜¯å¦ä¸ºç›¸åŒçš„vnodeç±»å‹")])]),s._v(" "),a("ul",[a("li",[s._v("å¦‚æœä¸åŒ, åˆ™é”€æ¯æ—§èŠ‚ç‚¹ã€‚æ¯”å¦‚ä¸€ä¸ªdivæ›´æ–°æˆp, æœ€ç®€å•çš„æ“ä½œå°±æ˜¯åˆ é™¤div, åœ¨æŒ‚è½½æ–°çš„pèŠ‚ç‚¹")]),s._v(" "),a("li",[s._v("å¦‚æœæ˜¯ç›¸åŒçš„vnodeç±»å‹, å°±éœ€è¦èµ°diffæ›´æ–°æµç¨‹äº†")])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("ä»–çš„æ›´æ–°æµç¨‹å·²ç»æ˜¯æ ¹æ®ä¸åŒçš„vnodeç±»å‹èµ°ä¸åŒçš„å¤„ç†é€»è¾‘, ä¾ç„¶æ˜¯ä¸»è¦çœ‹æ™®é€šå…ƒç´ èŠ‚ç‚¹å’Œç»„ä»¶çš„å¤„ç†æµç¨‹")])]),s._v(" "),a("ul",[a("li",[s._v("å¤„ç†ç»„ä»¶\n"),a("ul",[a("li",[s._v("ç»„ä»¶çš„æ›´æ–°æœ€ç»ˆè¿˜æ˜¯è¦è½¬æ¢æˆå†…éƒ¨çœŸå®DOMçš„æ›´æ–°, è€Œæ™®é€šå…ƒç´ çš„å¤„ç†æµç¨‹æ‰æ˜¯çœŸæ­£åšDOMæ›´æ–°")]),s._v(" "),a("li",[s._v("ç»„ä»¶æ›´æ–°ä¾ç„¶è°ƒç”¨"),a("RouterLink",{attrs:{to:"/blogs/vue3-resource/core/4.html#processcomponent"}},[s._v("processComponent")])],1)])]),s._v(" "),a("li",[s._v("å¤„ç†æ™®é€šå…ƒç´ èŠ‚ç‚¹\n"),a("ul",[a("li",[s._v("é€šè¿‡è°ƒç”¨ "),a("RouterLink",{attrs:{to:"/blogs/vue3-resource/core/4.html#processelement"}},[s._v("processElement")])],1)])])]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" patch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("PatchFn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    anchor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    parentComponent "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    parentSuspense "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    isSVG "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    slotScopeIds "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    optimized "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// patching & not same type, unmount old tree")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¦‚æœå­˜åœ¨æ–°æ—§èŠ‚ç‚¹, ä¸”æ–°æ—§èŠ‚ç‚¹ç±»å‹ä¸åŒï¼Œåˆ™é”€æ¯æ—§èŠ‚ç‚¹")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("isSameVNodeType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      anchor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getNextHostNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unmount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("patchFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" PatchFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BAIL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      optimized "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n      n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dynamicChildren "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" shapeFlag "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n2\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("switch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" Text"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†æ–‡æœ¬èŠ‚ç‚¹")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("processText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" Comment"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†æ³¨é‡ŠèŠ‚ç‚¹")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("processCommentNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" Static"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†é™æ€èŠ‚ç‚¹")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mountStaticNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patchStaticNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" Fragment"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†Fragment")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("processFragment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n          n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          optimized\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELEMENT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†æ™®é€šDOMå…ƒç´ ")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("processElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            optimized\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("COMPONENT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†ç»„ä»¶")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("processComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            optimized\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TELEPORT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†TELEPORT")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typeof")]),s._v(" TeleportImpl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            n1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" TeleportVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            n2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" TeleportVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            optimized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            internals\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__FEATURE_SUSPENSE__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" shapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SUSPENSE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†SUSPENSE")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typeof")]),s._v(" SuspenseImpl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            optimized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            internals\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Invalid VNode type:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typeof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// set ref")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ref "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setRef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br"),a("span",{staticClass:"line-number"},[s._v("115")]),a("br"),a("span",{staticClass:"line-number"},[s._v("116")]),a("br"),a("span",{staticClass:"line-number"},[s._v("117")]),a("br"),a("span",{staticClass:"line-number"},[s._v("118")]),a("br"),a("span",{staticClass:"line-number"},[s._v("119")]),a("br"),a("span",{staticClass:"line-number"},[s._v("120")]),a("br"),a("span",{staticClass:"line-number"},[s._v("121")]),a("br")])]),a("h2",{attrs:{id:"processcomponent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processcomponent"}},[s._v("#")]),s._v(" processComponent")]),s._v(" "),a("p",[s._v("å’Œæ¸²æŸ“è¿‡ç¨‹ç±»ä¼¼, æ›´æ–°è¿‡ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªæ ‘çš„æ·±åº¦ä¼˜å…ˆéå†è¿‡ç¨‹")]),s._v(" "),a("p",[s._v("ä¸»è¦é€šè¿‡æ‰§è¡Œ "),a("RouterLink",{attrs:{to:"/blogs/vue3-resource/core/4.html#updatecomponent"}},[s._v("updateComponent")]),s._v(" å‡½æ•°æ›´æ–°å­ç»„ä»¶")],1),s._v(" "),a("p",[s._v("é€šè¿‡ä¸‹é¢çš„åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“, processComponent å¤„ç†ç»„ä»¶ vnodeï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å»åˆ¤æ–­å­ç»„ä»¶æ˜¯å¦éœ€è¦æ›´æ–°")]),s._v(" "),a("p",[s._v("å¦‚æœéœ€è¦åˆ™é€’å½’æ‰§è¡Œå­ç»„ä»¶çš„å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•°æ¥æ›´æ–°")]),s._v(" "),a("p",[s._v("å¦åˆ™ä»…ä»…æ›´æ–°ä¸€äº› vnode çš„å±æ€§ï¼Œå¹¶è®©å­ç»„ä»¶å®ä¾‹ä¿ç•™å¯¹ç»„ä»¶ vnode çš„å¼•ç”¨ï¼Œç”¨äºå­ç»„ä»¶è‡ªèº«æ•°æ®å˜åŒ–å¼•èµ·ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œåœ¨æ¸²æŸ“å‡½æ•°å†…éƒ¨å¯ä»¥æ‹¿åˆ°æ–°çš„ç»„ä»¶ vnodeã€‚")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("processComponent")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    n1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    n2"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    container"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RendererElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    anchor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RendererNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    parentComponent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ComponentInternalInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    parentSuspense"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" SuspenseBoundary "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    isSVG"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    slotScopeIds"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    optimized"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("boolean")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("slotScopeIds "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" slotScopeIds\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¦‚æœn1(æ—§çš„vnode)ä¸å­˜åœ¨, åˆ™æ‰§è¡ŒæŒ‚è½½é€»è¾‘(æŒ‚è½½åˆ†ä¸ºç¼“å­˜ç»„ä»¶ç›´æ¥æ¿€æ´»å’Œæ–°ç»„ä»¶æŒ‚è½½)")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æŒ‚è½½ç»„ä»¶")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ—§çš„vnodeå­˜åœ¨, åˆ™æ‰§è¡Œæ›´æ–°é€»è¾‘")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" optimized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"updatecomponent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#updatecomponent"}},[s._v("#")]),s._v(" updateComponent")]),s._v(" "),a("p",[s._v("updateComponentå‡½æ•°åœ¨æ›´æ–°å­ç»„ä»¶çš„æ—¶å€™ä¼šå…ˆæ‰§è¡Œ "),a("code",[s._v("shouldUpdateComponent")]),s._v(" å‡½æ•°, æ ¹æ®æ–°æ—§å­ç»„ä»¶vnodeæ¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°å­ç»„ä»¶")]),s._v(" "),a("p",[s._v("åœ¨ shouldUpdateComponent å‡½æ•°å†…éƒ¨, ä¸»è¦æ˜¯é€šè¿‡æ£€æµ‹å’Œå¯¹æ¯”ç»„ä»¶vnodeä¸­çš„props, children, dirs, transitionç­‰å±æ€§, æ¥å†³å®šå­ç»„ä»¶æ˜¯å¦éœ€è¦æ›´æ–°")]),s._v(" "),a("p",[s._v("å› ä¸ºä¸€ä¸ªç»„ä»¶çš„å­ç»„ä»¶æ˜¯å¦éœ€è¦æ›´æ–°, ä¸»è¦ä¾æ®å­ç»„ä»¶vnodeæ˜¯å¦å­˜åœ¨ä¸€äº›ä¼šå½±å“ç»„ä»¶æ›´æ–°çš„å±æ€§å˜åŒ–è¿›è¡Œåˆ¤æ–­, å¦‚æœå­˜åœ¨å°±ä¼šæ›´æ–°å­ç»„ä»¶")]),s._v(" "),a("blockquote",[a("p",[s._v("è™½ç„¶vueçš„æ›´æ–°ç²’åº¦æ˜¯ç»„ä»¶çº§åˆ«çš„, ç»„ä»¶çš„æ•°æ®å˜åŒ–åªä¼šå½±å“å½“å‰ç»„ä»¶çš„æ›´æ–°")]),s._v(" "),a("p",[s._v("ä½†æ˜¯åœ¨ç»„ä»¶æ›´æ–°çš„è¿‡ç¨‹ä¸­, ä¹Ÿä¼šå¯¹å­ç»„ä»¶åšä¸€å®šçš„æ£€æŸ¥, åˆ¤æ–­å­ç»„ä»¶æ˜¯å¦ä¹Ÿéœ€è¦æ›´æ–°, å¹¶é€šè¿‡æŸç§æœºåˆ¶é¿å…å­ç»„ä»¶é‡å¤æ›´æ–°")]),s._v(" "),a("p",[s._v("åœ¨updateComponentå‡½æ•°ä¸­, å¦‚æœ "),a("code",[s._v("shouldUpdateComponent")]),s._v("å‡½æ•°æ‰§è¡Œè¿”å›true, é‚£ä¹ˆåœ¨å®ƒçš„æœ€å, å…ˆæ‰§è¡Œ"),a("code",[s._v("invalidateJob(instance.update)")]),s._v("æ¥é¿å…å­ç»„ä»¶å› è‡ªèº«æ•°æ®å˜åŒ–å¯¼è‡´çš„é‡å¤æ›´æ–°")]),s._v(" "),a("p",[s._v("ç„¶åç»§ç»­æ‰§è¡Œå­ç»„ä»¶çš„å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•° "),a("code",[s._v("instance.update")]),s._v("æ¥ä¸»åŠ¨è§¦å‘å­ç»„ä»¶çš„æ›´æ–°")]),s._v(" "),a("p",[s._v("æ¥ç€è¿›å…¥"),a("RouterLink",{attrs:{to:"/blogs/vue3-resource/core/4.html#update"}},[s._v("instance.update")])],1),s._v(" "),a("p",[s._v("å¦‚æœä¸éœ€è¦æ›´æ–°, åˆ™å­ç»„ä»¶å®ä¾‹ä¿ç•™å¯¹ç»„ä»¶vnodeçš„å¼•ç”¨, ä»…ä»…æ›´æ–°ä¸€äº›vnodeçš„å±æ€§")]),s._v(" "),a("p",[s._v("åœ¨å­ç»„ä»¶è‡ªèº«æ•°æ®å˜åŒ–å¼•èµ·ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ—¶å€™, å†æ¸²æŸ“å‡½æ•°å†…éƒ¨å¯ä»¥æ‹¿åˆ°æ–°çš„ç»„ä»¶vnode")])]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("updateComponent")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" optimized"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" instance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("component "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ ¹æ®æ–°æ—§å­ç»„ä»¶vnodeåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("shouldUpdateComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" optimized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        __FEATURE_SUSPENSE__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n        instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("asyncDep "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("asyncResolved\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¼‚æ­¥ç»„ä»¶æ›´æ–°é€»è¾‘")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ–°çš„å­ç»„ä»¶vnodeèµ‹å€¼ç»™instance.next")]),s._v("\n        instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n2\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å­ç»„ä»¶ä¹Ÿå¯èƒ½å› ä¸ºæ•°æ®å˜åŒ–è¢«æ·»åŠ åˆ°æ›´æ–°é˜Ÿåˆ—é‡Œäº†, ç§»é™¤ä»–ä»¬é˜²æ­¢å¯¹ä¸€ä¸ªå­ç»„ä»¶é‡å¤æ›´æ–°")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invalidateJob")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ‰§è¡Œå­ç»„ä»¶çš„å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•°")]),s._v("\n        instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸éœ€è¦æ›´æ–°åˆ™ç›´æ¥å¤åˆ¶åŸç»„ä»¶å³å¯")]),s._v("\n      n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("component "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("component\n      n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el\n      instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n2\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h2",{attrs:{id:"update"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#update"}},[s._v("#")]),s._v(" update")]),s._v(" "),a("p",[s._v("updateå‡½æ•°å…¶å®å®šä¹‰äºsetupRenderEffect(å‰¯ä½œç”¨æ¸²æŸ“å‡½æ•°)ä¸­")]),s._v(" "),a("p",[s._v("å…¶å®ç»„ä»¶æ›´æ–°çš„é€»è¾‘å¾ˆå¥½ç†è§£ï¼š")]),s._v(" "),a("ol",[a("li",[s._v("åœ¨æ›´æ–°ç»„ä»¶çš„DOMå‰, éœ€è¦å…ˆæ›´æ–°ç»„ä»¶vnodeèŠ‚ç‚¹ä¿¡æ¯, åŒ…æ‹¬æ›´æ”¹ç»„ä»¶å®ä¾‹çš„vnodeæŒ‡é’ˆ, æ›´æ–°propså’Œæ›´æ–°æ’æ§½ç­‰ä¸€ç³»åˆ—æ“ä½œ")]),s._v(" "),a("li",[s._v("å› ä¸ºç»„ä»¶åœ¨ç¨åæ‰§è¡ŒrenderComponentRootæ—¶ä¼šé‡æ–°æ¸²æŸ“æ–°çš„å­æ ‘vnode, ä¾èµ–äº†æ›´æ–°åçš„ç»„ä»¶vnodeä¸­çš„propså’Œslotsç­‰æ•°æ®")]),s._v(" "),a("li",[s._v("ä¸»è¦é€šè¿‡ updateComponentPreRenderå®ç°, ä¸»è¦åšäº†å¦‚ä¸‹æ“ä½œ")])]),s._v(" "),a("ul",[a("li",[s._v("åœ¨ updateComponentPreRender ä¸­")]),s._v(" "),a("li",[s._v("é¦–å…ˆå°†æ–°ç»„ä»¶vnodeçš„componentå±æ€§æŒ‡å‘ç»„ä»¶å®ä¾‹")]),s._v(" "),a("li",[s._v("ç¼“å­˜æ—§ç»„ä»¶vnodeçš„propså±æ€§")]),s._v(" "),a("li",[s._v("ç»„ä»¶å®ä¾‹çš„vnodeå±æ€§æŒ‡å‘æ–°çš„ç»„ä»¶vnode")]),s._v(" "),a("li",[s._v("æ¸…ç©ºnextå±æ€§, ä¸ºä¸‹ä¸€æ¬¡æ›´æ–°åšå‡†å¤‡")]),s._v(" "),a("li",[s._v("æ›´æ–°props")]),s._v(" "),a("li",[s._v("æ›´æ–°æ’æ§½")])]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// updateComponentPreRender")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("updateComponentPreRender")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  instance"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ComponentInternalInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  nextVNode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  optimized"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("boolean")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ–°ç»„ä»¶vnodeçš„componentå±æ€§æŒ‡å‘ç»„ä»¶å®ä¾‹")]),s._v("\n  nextVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("component "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" instance\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç¼“å­˜æ—§ç»„ä»¶vnodeçš„propså±æ€§")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" prevProps "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç»„ä»¶å®ä¾‹çš„vnodeå±æ€§æŒ‡å‘æ–°çš„ç»„ä»¶vnode")]),s._v("\n  instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nextVNode\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¸…ç©ºnextå±æ€§, ä¸ºäº†ä¸‹ä¸€æ¬¡æ›´æ–°å‡†å¤‡")]),s._v("\n  instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°props")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateProps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nextVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" prevProps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" optimized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°æ’æ§½")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateSlots")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nextVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("æ‰€ä»¥ä¸€ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“å¯èƒ½ä¼šæœ‰ä¸¤ç§æƒ…å†µ:")])]),s._v(" "),a("ul",[a("li",[s._v("ä¸€ç§æ˜¯ç»„ä»¶æœ¬èº«çš„æ•°æ®å˜åŒ–, è¿™ç§æƒ…å†µä¸‹nextæ˜¯null")]),s._v(" "),a("li",[s._v("å¦ä¸€ç§æ˜¯çˆ¶ç»„ä»¶åœ¨æ›´æ–°çš„è¿‡ç¨‹ä¸­, é‡åˆ°å­ç»„ä»¶èŠ‚ç‚¹, å…ˆåˆ¤æ–­å­ç»„ä»¶æ˜¯å¦éœ€è¦æ›´æ–°")]),s._v(" "),a("li",[s._v("å¦‚æœéœ€è¦åˆ™ä¸»åŠ¨æ‰§è¡Œå­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“æ–¹æ³•, è¿™ç§æƒ…å†µä¸‹nextå°±æ˜¯æ–°çš„å­ç»„ä»¶vnode")])]),s._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[s._v("è¿™ä¸ªåœ°æ–¹å¯èƒ½è¿˜ä¼šå­˜åœ¨ä¸€ä¸ªç–‘é—®, é‚£å°±æ˜¯è¿™ä¸ªå­ç»„ä»¶å¯¹åº”çš„æ–°çš„ç»„ä»¶vnodeæ˜¯ä»€ä¹ˆæ—¶å€™åˆ›å»ºçš„å‘¢?")])]),s._v(" "),a("ul",[a("li",[s._v("ç­”æ¡ˆå¾ˆç®€å•, ä»–æ˜¯åœ¨çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“çš„è¿‡ç¨‹ä¸­, é€šè¿‡renderComponentRootæ¸²æŸ“å­æ ‘vnodeçš„æ—¶å€™ç”Ÿæˆ")]),s._v(" "),a("li",[s._v("å› ä¸ºå­æ ‘vnodeæ˜¯ä¸ªæ ‘å½¢ç»“æ„, é€šè¿‡éå†å®ƒçš„å­èŠ‚ç‚¹å°±å¯ä»¥è®¿é—®åˆ°å…¶å¯¹åº”çš„ç»„ä»¶vnode")])]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("update "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("effect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("componentEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("isMounted"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆå§‹æ¸²æŸ“é€»è¾‘")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°ç»„ä»¶")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// updateComponent")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// This is triggered by mutation of component's own state (next: null)")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// OR parent calling processComponent (next: VNode)")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" u"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vnode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" instance\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" originNext "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" next\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" vnodeHook"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNodeHook "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("undefined")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__DEV__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pushWarningContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// nextè¡¨ç¤ºæ–°çš„ç»„ä»¶VNode")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¿™é‡Œå…ˆåˆ¤æ–­æ–°çš„ç»„ä»¶å®ä¾‹ä¸­æ˜¯å¦æœ‰æ–°çš„ç»„ä»¶VNode(è¿™é‡Œè®¾è®¡ä¸€ä¸ªç»„ä»¶æ›´æ–°çš„é€»è¾‘, ç¨åä¼šè¯´, è¿™ä¹Ÿæ˜¯éœ€è¦åˆ¤æ–­çš„åŸå› )")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æœ‰åˆ™æ›´æ–°ç»„ä»¶VNode")]),s._v("\n          next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°ç»„ä»¶vnodeèŠ‚ç‚¹ä¿¡æ¯")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateComponentPreRender")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" optimized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ²¡æœ‰åˆ™nextæŒ‡å‘ä¹‹å‰çš„ç»„ä»¶VNode")]),s._v("\n          next "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vnode\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¸²æŸ“æ–°çš„å­æ ‘vnode")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" nextTree "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("renderComponentRoot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç¼“å­˜æ—§çš„å­æ ‘vnode")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" prevTree "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subTree\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°å­æ ‘vnode")]),s._v("\n        instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subTree "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nextTree\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç»„ä»¶æ›´æ–°æ ¸å¿ƒé€»è¾‘, æ ¹æ®æ–°æ—§å­æ ‘vnodeåšpatch")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n          prevTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          nextTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// parent may have changed if it's in a teleport")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¦‚æœåœ¨teleportç»„ä»¶ä¸­çˆ¶èŠ‚ç‚¹å¯èƒ½å·²ç»æ”¹å˜, æ‰€ä»¥å®¹å™¨ç›´æ¥æ‰¾æ—§æ ‘DOMå…ƒç´ çš„çˆ¶èŠ‚ç‚¹")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostParentNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prevTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// anchor may have changed if it's in a fragment")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‚è€ƒèŠ‚ç‚¹(é”šç‚¹)åœ¨fragmentçš„æƒ…å†µå¯èƒ½æ”¹å˜, æ‰€ä»¥ç›´æ¥æ‰¾æ—§æ ‘DOMå…ƒç´ çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getNextHostNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prevTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          isSVG\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç¼“å­˜æ›´æ–°åçš„DOMèŠ‚ç‚¹")]),s._v("\n        next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nextTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("originNext "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// self-triggered update. In case of HOC, update parent component")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vnode el. HOC is indicated by parent instance's subTree pointing")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// to child component's vnode")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateHOCHostEl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nextTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __DEV__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("createDevEffectOptions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" prodEffectOptions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br")])]),a("h2",{attrs:{id:"processelement"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processelement"}},[s._v("#")]),s._v(" processElement")]),s._v(" "),a("p",[s._v("å…ƒç´ æ›´æ–°é€»è¾‘æ ¸å¿ƒå°±æ˜¯æ‰§è¡Œ patchElement")]),s._v(" "),a("p",[s._v("è€Œåœ¨patchElementä¸­, ä¹Ÿåªåšä¸¤ä»¶äº‹:")]),s._v(" "),a("ul",[a("li",[s._v("æ›´æ–°props\n"),a("ul",[a("li",[s._v("ä¸‹é¢çš„ patchPropså‡½æ•°å°±æ˜¯åœ¨æ›´æ–°DOMèŠ‚ç‚¹çš„class, style, eventä»¥åŠå…¶ä»–çš„ä¸€äº›DOMå±æ€§")])])]),s._v(" "),a("li",[s._v("æ›´æ–°å­èŠ‚ç‚¹\n"),a("ul",[a("li",[s._v("è¿™é‡Œçœ‹ä¸€ä¸‹patchChildrençš„å®ç°\n"),a("ul",[a("li",[s._v("é¦–å…ˆæ ¹æ®patchFlag > 0ä¹Ÿå°±æ˜¯å­˜åœ¨patchFlag, è¿›ä¸€æ­¥åˆ¤æ–­æ˜¯å¦å¤„ç†fragment")]),s._v(" "),a("li",[s._v("å¦‚æœæœ‰, åˆ™å¤„ç†fragment")]),s._v(" "),a("li",[s._v("æ¥ç€å¤„ç†éfragmentçš„å­èŠ‚ç‚¹, å…±ä¸‰ç§æƒ…å†µ, æ•°ç»„ã€æ–‡æœ¬èŠ‚ç‚¹å’Œç©ºèŠ‚ç‚¹")]),s._v(" "),a("li",[s._v("å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹, ä¹‹å‰æ˜¯æ•°ç»„, åˆ™åˆ é™¤åŸæœ‰å­èŠ‚ç‚¹")]),s._v(" "),a("li",[s._v("å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹, ä¹‹å‰æ˜¯æ–‡æœ¬, ä¸”ä¸¤ä¸ªæ–‡æœ¬å†…å®¹ä¸ç­‰, åˆ™ç›´æ¥æ›´æ–°æ–‡æœ¬å†…å®¹, æ›¿æ¢æ–°çš„æ–‡æœ¬")]),s._v(" "),a("li",[s._v("å¦‚æœä¹‹å‰å­èŠ‚ç‚¹æ˜¯æ•°ç»„, æ–°çš„å­èŠ‚ç‚¹è¿˜æ˜¯æ•°ç»„, åˆ™æ‰§è¡Œ patchKeyedChildren, åšå®Œæ•´çš„diffæµç¨‹, å’Œæ›´æ–°å¸¦keyçš„fragmentç±»ä¼¼(è¿™æ˜¯æœ€å¤æ‚çš„æƒ…å†µ)")]),s._v(" "),a("li",[s._v("å¦‚æœä¹‹å‰å­èŠ‚ç‚¹æ˜¯æ•°ç»„, æ–°çš„å­èŠ‚ç‚¹æ˜¯æ–‡æœ¬æˆ–è€…ç©ºèŠ‚ç‚¹, åˆ™åˆ é™¤åŸæœ‰å­èŠ‚ç‚¹")]),s._v(" "),a("li",[s._v("å¦‚æœä¹‹å‰å­èŠ‚ç‚¹æ˜¯æ–‡æœ¬æˆ–è€…ç©º, æ–°çš„å­èŠ‚ç‚¹æ˜¯ç©ºèŠ‚ç‚¹, åˆ™å°†åŸæœ‰æ–‡æœ¬ä¿¡æ¯è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²(ä¸ç®¡åŸæ¥æ˜¯æ–‡æœ¬è¿˜æ˜¯ç©ºèŠ‚ç‚¹, ç°åœ¨æ˜¯ç©ºçš„éƒ½æ›´æ–°æˆç©ºçš„)")]),s._v(" "),a("li",[s._v("å¦‚æœä¹‹å‰å­èŠ‚ç‚¹æ˜¯æ–‡æœ¬æˆ–ç©º, æ–°çš„å­èŠ‚ç‚¹æ˜¯æ•°ç»„, åˆ™æŒ‚è½½æ–°çš„å­èŠ‚ç‚¹")])])])])])]),s._v(" "),a("blockquote",[a("p",[s._v("è¿™é‡Œç”¨å‡ å¼ å›¾è¡¨ç¤ºä¸Šè¿°æƒ…å†µ")])]),s._v(" "),a("ol",[a("li",[s._v("æ—§çš„å­èŠ‚ç‚¹æ˜¯çº¯æ–‡æœ¬\n"),a("img",{attrs:{src:n(596),alt:"çº¯æ–‡æœ¬æ—§èŠ‚ç‚¹"}})]),s._v(" "),a("li",[s._v("æ—§å­èŠ‚ç‚¹æ˜¯ç©º\n"),a("img",{attrs:{src:n(597),alt:"ç©ºèŠ‚ç‚¹æ—§èŠ‚ç‚¹"}})]),s._v(" "),a("li",[s._v("æ—§å­èŠ‚ç‚¹æ˜¯æ•°ç»„\n"),a("img",{attrs:{src:n(598),alt:"æ•°ç»„æ—§èŠ‚ç‚¹"}})])]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" patchChildren"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("PatchChildrenFn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    optimized "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" c1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("children\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" prevShapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" c2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("children\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" patchFlag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" shapeFlag "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n2\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// fast path")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("patchFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†æœ‰keyçš„fragment")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("patchFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" PatchFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("KEYED_FRAGMENT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// this could be either fully-keyed or mixed (some keyed some not)")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// presence of patchFlag means children are guaranteed to be arrays")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patchKeyedChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n          c1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          c2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNodeArrayChildren"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          optimized\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("patchFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" PatchFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UNKEYED_FRAGMENT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// unkeyed")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†æ²¡æœ‰keyçš„fragment")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patchUnkeyedChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n          c1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          c2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNodeArrayChildren"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          optimized\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// children has 3 possibilities: text, array or no children.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é€»è¾‘ä¸, äºŒè€…ç›¸ç­‰åˆ™è¿”å›ç›¸ç­‰çš„æ•°, å¦åˆ™ä¸º0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é™¤äº†fragementä¹‹å¤–, å­èŠ‚ç‚¹è¿˜æœ‰ 3 ç§å¯èƒ½æƒ…å†µï¼šæ–‡æœ¬ã€æ•°ç»„ã€ç©º")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TEXT_CHILDREN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å½“å‰èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// text children fast path")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prevShapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ARRAY_CHILDREN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ•°ç»„ -> æ–‡æœ¬çš„æ›´æ–°, åˆ é™¤ä¹‹å‰çš„å­èŠ‚ç‚¹")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unmountChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ–‡æœ¬å¯¹æ¯”ä¸åŒ, åˆ™æ›¿æ¢æ–°æ–‡æœ¬")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostSetElementText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" c2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prevShapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ARRAY_CHILDREN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¹‹å‰çš„èŠ‚ç‚¹æ˜¯æ•°ç»„")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// prev children was array")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ARRAY_CHILDREN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç°åœ¨çš„èŠ‚ç‚¹ä¹Ÿæ˜¯æ•°ç»„, åšå®Œæ•´diffæµç¨‹")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// two arrays, cannot assume anything, do full diff")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patchKeyedChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            c1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            c2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNodeArrayChildren"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            optimized\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ•°ç»„ -> éæ–‡æœ¬çš„å•èŠ‚ç‚¹, åŒæ ·åˆ é™¤åŸæ¥çš„èŠ‚ç‚¹")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// no new children, just unmount old")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unmountChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¹‹å‰çš„å­èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹æˆ–è€…ç©º")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ–°çš„å­èŠ‚ç‚¹æ˜¯æ•°ç»„æˆ–è€…ç©º")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// prev children was text OR null")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// new children is array OR null")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prevShapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TEXT_CHILDREN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¹‹å‰æ˜¯æ–‡æœ¬èŠ‚ç‚¹, åˆ™å°†å…¶æ¸…ç©º")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostSetElementText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// mount new if array")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shapeFlag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" ShapeFlags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ARRAY_CHILDREN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¦‚æœæ–°èŠ‚ç‚¹æ˜¯æ•°ç»„, åˆ™æŒ‚è½½æ–°çš„å­èŠ‚ç‚¹")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mountChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            c2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" VNodeArrayChildren"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            anchor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            optimized\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br"),a("span",{staticClass:"line-number"},[s._v("115")]),a("br")])]),a("p",[s._v("å…¶å®è¿™æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œå› ä¸ºä¸€ä¸ª DOM èŠ‚ç‚¹å…ƒç´ å°±æ˜¯ç”±å®ƒè‡ªèº«çš„ä¸€äº›å±æ€§å’Œå­èŠ‚ç‚¹æ„æˆçš„ã€‚")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("processElement")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  n1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  n2"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  container"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RendererElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  anchor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" RendererNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  parentComponent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ComponentInternalInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  parentSuspense"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" SuspenseBoundary "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  isSVG"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  slotScopeIds"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  optimized"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("boolean")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æŒ‚è½½å…ƒç´ èŠ‚ç‚¹")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°å…ƒç´ èŠ‚ç‚¹")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patchElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      slotScopeIds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      optimized\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("patchElement")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" optimized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" el "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" oldProps "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EMPTY_OBJ")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" newProps "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EMPTY_OBJ")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–° props")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patchProps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oldProps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" newProps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" isSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" areChildrenSVG "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" isSVG "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'foreignObject'")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°å­èŠ‚ç‚¹")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("patchChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parentSuspense"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" areChildrenSVG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);