(window.webpackJsonp=window.webpackJsonp||[]).push([[176],{772:function(t,s,a){"use strict";a.r(s);var n=a(5),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"update"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#update"}},[t._v("#")]),t._v(" update")]),t._v(" "),a("blockquote",[a("p",[t._v("åœ¨"),a("code",[t._v("vm._render()")]),t._v("æ–¹æ³•ä¸­æœ€ç»ˆè°ƒç”¨äº†"),a("code",[t._v("createElement")]),t._v("å»åˆ›å»º"),a("code",[t._v("VNode")]),t._v("å¯¹è±¡")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥è¦å°†åˆ›å»ºå¥½çš„ "),a("code",[t._v("VNode")]),t._v(" å¯¹è±¡ä¼ é€’ç»™"),a("code",[t._v("vm._update")]),t._v("æ–¹æ³•")]),t._v(" "),a("p",[a("code",[t._v("update")]),t._v("æ–¹æ³•å°±æ˜¯åœ¨è°ƒç”¨"),a("code",[t._v("lifecycleMixin")]),t._v("æ—¶å®šä¹‰çš„, è€Œ"),a("code",[t._v("lifecycleMixin")]),t._v("å®šä¹‰äº"),a("code",[t._v("src/core/instance/lifecycle")]),t._v("ä¸­")]),t._v(" "),a("p",[t._v("è€Œ"),a("code",[t._v("lifecycleMixin")]),t._v("æ˜¯åœ¨"),a("code",[t._v("core/instance/index")]),t._v("ä¸­å®šä¹‰å®Œ Vue çš„æ„é€ å™¨åè°ƒç”¨çš„")])]),t._v(" "),a("h2",{attrs:{id:"vue-prototype-update"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-prototype-update"}},[t._v("#")]),t._v(" Vue.prototype._update")]),t._v(" "),a("blockquote",[a("p",[t._v("_update æ–¹æ³•çš„ä½œç”¨æ˜¯æŠŠ VNode æ¸²æŸ“æˆçœŸå®çš„ DOM")]),t._v(" "),a("p",[t._v("é¦–æ¬¡æ¸²æŸ“ä¼šè°ƒç”¨, æ•°æ®æ›´æ–°ä¹Ÿä¼šè°ƒç”¨("),a("code",[t._v("renderWatcher")]),t._v("è°ƒç”¨"),a("code",[t._v("get")]),t._v("æ—¶, è§¦å‘"),a("code",[t._v("updateComponent")]),t._v(")")]),t._v(" "),a("p",[t._v("æœ€æ ¸å¿ƒçš„éƒ¨åˆ†å°±æ˜¯è°ƒç”¨äº† "),a("code",[t._v("vm.__patch__")]),t._v(" æ–¹æ³•")])]),t._v(" "),a("ol",[a("li",[t._v("é€šè¿‡ vm è§¦å‘"),a("code",[t._v("_update")]),t._v("æ–¹æ³•, æ‰€ä»¥è¿™ä¸ª"),a("code",[t._v("const vm = this")]),t._v("ä¸­çš„"),a("code",[t._v("this")]),t._v("å…¶å®å°±æ˜¯å½“å‰å®ä¾‹å¯¹è±¡")]),t._v(" "),a("li",[t._v("å®šä¹‰ "),a("code",[t._v("prevEl")]),t._v(", æŒ‡å‘å½“å‰å®ä¾‹çš„"),a("code",[t._v("$el")]),t._v(", å¦‚æœæ˜¯äºŒæ¬¡æ¸²æŸ“, è¿™ä¸ªå€¼å°±å­˜å‚¨çš„ä¸Šä¸€æ¬¡çš„"),a("code",[t._v("çœŸå®DOMå¯¹è±¡")]),t._v(", å¦‚æœæ˜¯é¦–æ¬¡æ¸²æŸ“, å¯¹äºç»„ä»¶æ¥è¯´è¿™ä¸ªå€¼æ˜¯"),a("code",[t._v("undefined")]),t._v(", å¯¹äºå…¥å£æ¥è¯´è¿™ä¸ªå€¼å°±æ˜¯è®¾ç½®çš„æŒ‚è½½ç‚¹")]),t._v(" "),a("li",[t._v("å®šä¹‰ "),a("code",[t._v("prevVnode")]),t._v(", å°±æ˜¯ä»vueå®ä¾‹ä¸­è·å–"),a("code",[t._v("_vnode")]),t._v(", "),a("code",[t._v("_vnode")]),t._v("ä¸­è®°è½½çš„æ˜¯ä¹‹å‰æ‰€å¤„ç†çš„vnodeå¯¹è±¡, é¦–æ¬¡æ¸²æŸ“æ—¶è°ƒç”¨"),a("code",[t._v("_update")]),t._v("è¯¥å€¼ä¸ºundefined, æ‰€ä»¥è¯¥å€¼ä¸å­˜åœ¨åˆ™ä»£è¡¨é¦–æ¬¡æ¸²æŸ“")]),t._v(" "),a("li",[t._v("è°ƒç”¨"),a("RouterLink",{attrs:{to:"/blogs/vue-resource/virtualDOM/5.html#setactiveinstance"}},[t._v("setActiveInstance")]),t._v("(vm)è®¾ç½®æ¿€æ´»å®ä¾‹å¹¶ä¸”è¿”å›ä¸€ä¸ªå‡½æ•°, ç”¨äºåœ¨"),a("code",[t._v("__patch__")]),t._v("æ‰§è¡Œå®Œæ¯•åé‡ç½®æ¿€æ´»å®ä¾‹ï¼ˆé‡æ–°è®¾ç½®ä¸ºnullï¼‰")],1),t._v(" "),a("li",[t._v("è®¾ç½®"),a("code",[t._v("vm._vnode")]),t._v("ä¸ºå½“å‰"),a("code",[t._v("vnode")]),t._v("(æ‰€ä»¥éé¦–æ¬¡æ¸²æŸ“, éƒ½å­˜åœ¨vm._vnode, å°±æ˜¯æ­¤å¤„è®¾ç½®çš„)")]),t._v(" "),a("li",[t._v("å¦‚æœä¸å­˜åœ¨"),a("code",[t._v("prevVnode")]),t._v(", è¯´æ˜å½“å‰æ˜¯é¦–æ¬¡æ¸²æŸ“")])]),t._v(" "),a("ul",[a("li",[t._v("é¦–æ¬¡æ¸²æŸ“æ—¶, è°ƒç”¨"),a("code",[t._v("vm.__patch__(vm.$el, vnode, hydrating, false)")]),t._v(", vnodeå°±æ˜¯åˆšåˆšåˆ›å»ºçš„vnode")]),t._v(" "),a("li",[t._v("åœ¨"),a("code",[t._v("__patch__")]),t._v("æ–¹æ³•ä¸­, ä¼šå°†ä¼ å…¥çš„"),a("code",[t._v("vm.$el")]),t._v("è½¬æ¢ä¸ºvnode, ç„¶åå’Œæ–°çš„"),a("code",[t._v("vnode")]),t._v("è¿›è¡Œæ¯”è¾ƒ")]),t._v(" "),a("li",[t._v("ç„¶åå°†æ¯”è¾ƒçš„ç»“æœæ›´æ–°åˆ°çœŸå®DOM, æœ€åå°†å…¶è¿”å›å‡ºæ¥, è®¾ç½®åˆ°"),a("code",[t._v("vm.$el")]),t._v("ä¸Š")])]),t._v(" "),a("ol",{attrs:{start:"7"}},[a("li",[t._v("å¦‚æœæ˜¯æ•°æ®æ”¹å˜å, è°ƒç”¨"),a("code",[t._v("_update")]),t._v("æ–¹æ³•, æ­¤æ—¶"),a("code",[t._v("preVnode")]),t._v("å°±æœ‰å€¼äº†")])]),t._v(" "),a("ul",[a("li",[t._v("ä¾ç„¶æ˜¯è°ƒç”¨"),a("code",[t._v("vm.__patch__")]),t._v("æ–¹æ³•, åªä¸è¿‡æ˜¯ä¼ å…¥ "),a("code",[t._v("preVnode")]),t._v("å’Œæ–°çš„"),a("code",[t._v("vnode")])]),t._v(" "),a("li",[t._v("åœ¨å…¶ä¸­æ¯”è¾ƒä¸¤ä¸ªvnodeçš„å·®å¼‚")]),t._v(" "),a("li",[t._v("ç„¶åå°†å·®å¼‚æ›´æ–°åˆ°çœŸå®DOM, ç„¶åå°†æ–°çš„çœŸå®DOMè¿”å›, åœ¨æ›´æ–°åˆ°"),a("code",[t._v("vm.$el")]),t._v("ä¸­")])]),t._v(" "),a("ol",{attrs:{start:"8"}},[a("li",[t._v("æ‰§è¡Œ "),a("code",[t._v("restoreActiveInstance")]),t._v(" å°† "),a("code",[t._v("activeInstance")]),t._v(" è®¾ç½®ä¸º "),a("code",[t._v("null")])]),t._v(" "),a("li",[t._v("å§‹ç»ˆä¿æŒ"),a("code",[t._v("vm.$el.__vue__")]),t._v("æŒ‡å‘å½“å‰æœ€æ–°çš„vmå®ä¾‹")])]),t._v(" "),a("ul",[a("li",[t._v("å°†ä»¥å¾€çš„"),a("code",[t._v("vm.$el.__vue__")]),t._v("è®¾ç½®ä¸ºnull(å› ä¸ºæ˜¯ç›´æ¥æ‹·è´çš„, ä»–ä¿©æŒ‡å‘åŒä¸€ä¸ª"),a("code",[t._v("$el")]),t._v("), æ˜¯å› ä¸ºæ—§çš„"),a("code",[t._v("$el")]),t._v("å·²å¼ƒç”¨")]),t._v(" "),a("li",[t._v("å°†æ–°çš„"),a("code",[t._v("vm.$el.__vue__")]),t._v("è®¾ç½®ä¸ºå½“å‰å®ä¾‹å¯¹è±¡"),a("code",[t._v("vm")]),t._v(", æ›´æ–°ä¸€ä¸‹")])]),t._v(" "),a("ol",{attrs:{start:"10"}},[a("li",[t._v("å¤„ç†HOC(é«˜é˜¶ç»„ä»¶)")])]),t._v(" "),a("ul",[a("li",[t._v("åˆ¤æ–­ "),a("code",[t._v("vm.$vnode")]),t._v("å­˜åœ¨ä¸”"),a("code",[t._v("vm.$parent")]),t._v("å­˜åœ¨, å¹¶ä¸”"),a("code",[t._v("vm.$vnode === vm.$parent._vnode")])]),t._v(" "),a("li",[t._v("è¿›å…¥åˆ¤æ–­åå°†"),a("code",[t._v("vm.$parent.$el")]),t._v("è®¾ç½®ä¸º"),a("code",[t._v("vm.$el")])])]),t._v(" "),a("h3",{attrs:{id:"hoc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hoc"}},[t._v("#")]),t._v(" HOC")]),t._v(" "),a("blockquote",[a("p",[t._v("HOCä¸»è¦é’ˆå¯¹å¦‚ä¸‹æƒ…å†µ")]),t._v(" "),a("p",[t._v("å…³äºHOCåç»­åœ¨ç»„ä»¶ä¸­ç»†ğŸ”, è¿™é‡Œæš‚æ—¶å…ˆäº†è§£ä¸€ä¸‹")])]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("root")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("child1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("child1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("child2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("child21")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("child21")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("child2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("root")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("ul",[a("li",[t._v("$el: å½“å‰ç»„ä»¶å®ä¾‹å¯¹åº”çš„DOM")]),t._v(" "),a("li",[t._v("_vnode: å½“å‰ç»„ä»¶å®ä¾‹å¯¹åº”çš„vnode")]),t._v(" "),a("li",[t._v("$parent: å½“å‰ç»„ä»¶çš„çˆ¶ç»„ä»¶å®ä¾‹ "),a("code",[t._v("child21.parent = child2")]),t._v("ã€"),a("code",[t._v("child1.parent = root")])]),t._v(" "),a("li",[t._v("$vnode: å­ç»„ä»¶é¦–å…ˆæ¸²æŸ“å‡ºæ¥çš„å ä½èŠ‚ç‚¹(åœ¨çˆ¶ç»„ä»¶ä¸­çš„å¼•ç”¨èŠ‚ç‚¹, å°±æ˜¯ç»„ä»¶æ ‡ç­¾) æ‰€ä»¥"),a("code",[t._v("vnode.parent = $vnode")]),t._v("ï¼ˆæºç  Vue.prototype._render å‡½æ•°èµ‹å€¼ï¼‰ï¼Œ"),a("code",[t._v("$vnode")]),t._v(" å’Œ "),a("code",[t._v("_vnode")]),t._v(" çš„ "),a("code",[t._v("$el")]),t._v("ç›¸åŒï¼ŒæŒ‡å‘åŒä¸ªDOM")])]),t._v(" "),a("blockquote",[a("p",[t._v("é«˜é˜¶ç»„ä»¶HOC")]),t._v(" "),a("p",[t._v("HOC: "),a("code",[t._v("(component) => ({ template: <component></components> })")])]),t._v(" "),a("p",[t._v("æ‰€ä»¥ component è¿™ä¸ªç»„ä»¶ çš„çˆ¶èŠ‚ç‚¹æ˜¯HOCï¼Œ"),a("code",[t._v("vm(component).$vnode(åŒ…æ‹¬ç»„ä»¶æ ‡ç­¾) = vm(component).$parent(HOC)._vnode(ä¸åŒ…å«HOCæ ‡ç­¾)")]),t._v("ï¼Œæ‰€ä»¥éœ€è¦æ§åˆ¶"),a("code",[t._v("component")]),t._v("çš„"),a("code",[t._v("HOCç»„ä»¶")]),t._v("å¼•ç”¨åŒä¸€ä¸ª$el")])]),t._v(" "),a("h3",{attrs:{id:"æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[t._v("#")]),t._v(" æ€»ç»“:")]),t._v(" "),a("blockquote",[a("p",[t._v("updateæ–¹æ³•æ¯”è¾ƒç®€å•, ä¸»è¦å°±æ˜¯åˆ¤æ–­æ˜¯å¦æœ‰"),a("code",[t._v("prevVnode")])]),t._v(" "),a("p",[t._v("å¦‚æœæ²¡æœ‰"),a("code",[t._v("prevVnode")]),t._v("å°±æ˜¯é¦–æ¬¡æ¸²æŸ“, è°ƒç”¨"),a("code",[t._v("__patch")]),t._v("æ–¹æ³•, ç”¨ "),a("code",[t._v("vm.$el")]),t._v("ä¸æ–°çš„"),a("code",[t._v("vnode")]),t._v("åšæ¯”è¾ƒ, æ›´æ–°å·®å¼‚åˆ°çœŸå®DOM, ç„¶åè¿”å›çœŸå®DOMå¹¶è®¾ç½®ç»™"),a("code",[t._v("vm.$el")])]),t._v(" "),a("p",[t._v("å¦‚æœæœ‰"),a("code",[t._v("prevVnode")]),t._v(", è¯´æ˜æ˜¯æ•°æ®æ›´æ–°åæ¸²æŸ“, è°ƒç”¨"),a("code",[t._v("__patch__")]),t._v("æ–¹æ³•, ç”¨"),a("code",[t._v("prevVnode")]),t._v("ä¸æ–°çš„"),a("code",[t._v("vnode")]),t._v("ä½œæ¯”è¾ƒ, æ›´æ–°å·®å¼‚åˆ°çœŸå®DOM, ç„¶åè¿”å›çœŸå®DOMå¹¶è®¾ç½®ç»™"),a("code",[t._v("vm.$el")])])]),t._v(" "),a("h3",{attrs:{id:"æºç "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æºç "}},[t._v("#")]),t._v(" æºç ")]),t._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lifecycleMixin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Class"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("_update")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hydrating"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Component "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" prevEl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" prevVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_vnode\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" restoreActiveInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setActiveInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_vnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vnode\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Vue.prototype.__patch__ is injected in entry points")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// based on the rendering backend used.")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * é¦–æ¬¡æ¸²æŸ“")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("prevVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// initial render")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vueåŸå‹ä¸­çš„ __patch__ æ–¹æ³•æ˜¯åœ¨å…¥å£ä¸­è¢«æ³¨å…¥çš„")]),t._v("\n      vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("__patch__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hydrating"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* removeOnly */")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// updates")]),t._v("\n      vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("__patch__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prevVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å§‹ç»ˆä¿æŒactiveInstanceå’ŒprevActiveInstanceæ˜¯ä¸€ä¸ªçˆ¶å­å…³ç³» ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("restoreActiveInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// update __vue__ reference")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prevEl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      prevEl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__vue__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__vue__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// if parent is an HOC, update its $el as well")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$vnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$parent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$vnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// updated hook is called by the scheduler to ensure that children are")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// updated in a parent's updated hook.")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br")])]),a("h2",{attrs:{id:"setactiveinstance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setactiveinstance"}},[t._v("#")]),t._v(" setActiveInstance")]),t._v(" "),a("blockquote",[a("p",[t._v("ä¸»è¦æ˜¯è®¾ç½®æ¿€æ´»å®ä¾‹, ä¸»è¦æ˜¯åœ¨æŒ‚è½½ç»„ä»¶æ—¶, éœ€è¦å°†å½“å‰å®ä¾‹ä½œä¸ºæ‰€æœ‰ç»„ä»¶çš„çˆ¹")])]),t._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" activeInstance"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setActiveInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * åœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œä¹‹æ‰€ä»¥å°†vmä½œä¸ºactiveInstanceï¼Œå°±æ˜¯å› ä¸ºç»„ä»¶æ˜¯ä½œä¸ºå½“å‰å®ä¾‹çš„å„¿å­ï¼Œå› æ­¤ï¼Œä¼šæŠŠå½“å‰å®ä¾‹å½“æˆçˆ¶çº§vmå®ä¾‹ï¼Œä¿å­˜ä¸‹æ¥")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" prevActiveInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" activeInstance\n  activeInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    activeInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" prevActiveInstance\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);