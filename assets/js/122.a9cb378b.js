(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{666:function(t,s,n){"use strict";n.r(s);var a=n(5),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"init方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#init方法"}},[t._v("#")]),t._v(" _init方法")]),t._v(" "),n("p",[t._v("当所有的实例成员初始化完成, 随后在"),n("code",[t._v("initGlobalAPI")]),t._v("中完成静态成员的初始化, 于"),n("code",[t._v("runtime/index")]),t._v("中增加实例成员"),n("code",[t._v("$mount")]),t._v(", 最后在入口文件中做完一切调整后, Vue构造函数的初始化正式结束。")]),t._v(" "),n("p",[t._v("然后在项目中引入Vue后, 我们将创建Vue实例对象, 也就是执行"),n("code",[t._v("new Vue(options)")]),t._v(", 此时将触发Vue的构造函数, 其实就是执行"),n("code",[t._v("this._init(options)")]),t._v(", 该方法在"),n("code",[t._v("initMixin")]),t._v("中初始化")]),t._v(" "),n("h2",{attrs:{id:"init执行过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#init执行过程"}},[t._v("#")]),t._v(" _init执行过程")]),t._v(" "),n("ol",[n("li",[t._v("首先定义了vm对象, 指向vue实例")]),t._v(" "),n("li",[t._v("定义"),n("code",[t._v("_uid")]),t._v("属性, 作为组件的唯一标识")]),t._v(" "),n("li",[t._v("开发环境下的性能检测, 与具体功能无关")]),t._v(" "),n("li",[t._v("给vm定义了一个"),n("code",[t._v("_isVue")]),t._v("属性, 标识当前实例是vue的实例, 目的是将来设置响应式数据时, 不对vm做处理(否则会通过递归Object.defineProperty给vm上所有属性增加响应式, 影响初始化性能)")]),t._v(" "),n("li",[t._v("合并options, 都是合并"),n("code",[t._v("用户传入的options")]),t._v("与"),n("code",[t._v("Vue构造函数上的options")]),t._v(", 在静态成员初始化时, 已经在构造函数的options上设置了"),n("code",[t._v("v-show")]),t._v(", "),n("code",[t._v("v-model")]),t._v(", "),n("code",[t._v("keep-alive")]),t._v(", "),n("code",[t._v("directive")]),t._v(", "),n("code",[t._v("component")]),t._v(", "),n("code",[t._v("filter")]),t._v("等指令和组件")])]),t._v(" "),n("ul",[n("li",[t._v("是组件执行"),n("code",[t._v("_init")]),t._v("时, 则使用"),n("code",[t._v("initInternalComponent")]),t._v("合并"),n("code",[t._v("options")])]),t._v(" "),n("li",[t._v("非组件初始化时, 则使用"),n("code",[t._v("mergeOptions")]),t._v("并且将合并后的结果放到"),n("code",[t._v("vm.$options")]),t._v("上")])]),t._v(" "),n("ol",{attrs:{start:"6"}},[n("li",[t._v("设置"),n("code",[t._v("renderProxy")]),t._v(", 也就是渲染后的代理对象, 生产环境下就是vm实例, 开发环境中调用"),n("code",[t._v("initProxy")])])]),t._v(" "),n("ul",[n("li",[t._v("initProxy实现")])]),t._v(" "),n("div",{staticClass:"language-ts line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ts"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("initProxy")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initProxy")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hasProxy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 如果浏览器支持Proxy")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * Proxy主要是对对象访问做一个劫持，在此处handlers指向的是hasHandler")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" handlers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("render "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("render"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_withStripped\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" getHandler\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" hasHandler\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 代理配置")]),t._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_renderProxy "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handlers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_renderProxy "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br")])]),n("ol",[n("li",[t._v("判断当前环境下是否有Proxy对象, 方式为"),n("code",[t._v("typeof Proxy === 'function' && /native code/.test(Proxy.toString())")])]),t._v(" "),n("li",[t._v("如果当前环境下存在Proxy对象, 则通过"),n("code",[t._v("new Proxy()")]),t._v("的方式初始化"),n("code",[t._v("renderProxy")])]),t._v(" "),n("li",[t._v("如果当期环境不支持Proxy对象, 则将"),n("code",[t._v("renderProxy")]),t._v("直接指向当前实例")]),t._v(" "),n("li",[t._v("紧接着通过几个init函数, 通过这些函数对vue实例进行初始化")]),t._v(" "),n("li",[t._v("在"),n("code",[t._v("initLifecycle")]),t._v("中先找到当前实例的"),n("code",[t._v("parent(父组件)")]),t._v(", 然后将当前实例添加到"),n("code",[t._v("parent.$children")]),t._v("中")]),t._v(" "),n("li",[t._v("然后初始化了"),n("code",[t._v("$parent")]),t._v(", "),n("code",[t._v("$children")]),t._v(", "),n("code",[t._v("$root")]),t._v(", "),n("code",[t._v("$refs")]),t._v(", 以及一些以下划线开头的私有成员"),n("code",[t._v("_watcher")]),t._v(", "),n("code",[t._v("_inactive")]),t._v(", "),n("code",[t._v("_directInactive")]),t._v(", "),n("code",[t._v("_isMounted")]),t._v(", "),n("code",[t._v("_isDestroyed")]),t._v("和"),n("code",[t._v("_isBeingDestroyed")])]),t._v(" "),n("li",[n("code",[t._v("initEvents")]),t._v("用于初始化组件的事件处理函数\n"),n("ol",[n("li",[t._v("首先定义了"),n("code",[t._v("_events")]),t._v("用于存储事件名称以及对应的处理函数(Record<事件名称, Array<处理函数>>)")]),t._v(" "),n("li",[t._v("当调用"),n("code",[t._v("$on")]),t._v("的时候, 就会将事件存储到"),n("code",[t._v("_events")]),t._v("中, 之前分析"),n("code",[t._v("$on")]),t._v("时说过")]),t._v(" "),n("li",[t._v("获取父元素上附加的事件, 将当前父组件中附加的事件注册到当前组件上来")]),t._v(" "),n("li",[t._v("所以"),n("code",[t._v("initEvents")]),t._v("的核心其实是获取父元素直接传递的事件, 并且注册到当前组件上")])])]),t._v(" "),n("li",[n("code",[t._v("initRender")]),t._v(", 初始化render函数(也就是h), 并且初始化了几个属性"),n("code",[t._v("$slots/$scopedSlots/_c/createElement/$attrs/$listeners")]),t._v(" "),n("ol",[n("li",[t._v("首先初始化了"),n("code",[t._v("$slots")]),t._v("和"),n("code",[t._v("$scopedSlots")]),t._v("两个和插槽相关的方法")]),t._v(" "),n("li",[t._v("然后是"),n("code",[t._v("_c")]),t._v("和"),n("code",[t._v("$createElement")]),t._v(", 这个"),n("code",[t._v("createElement")]),t._v("就是在render函数中使用的"),n("code",[t._v("h")]),t._v("函数, 作用就是创建虚拟dom")]),t._v(" "),n("li",[n("code",[t._v("_c")]),t._v("用于对编译生成的"),n("code",[t._v("render")]),t._v("函数进行转换, "),n("code",[t._v("$createElement")]),t._v("则是用于转换用户手写的"),n("code",[t._v("render")]),t._v("函数")]),t._v(" "),n("li",[t._v("初始化了"),n("code",[t._v("$attrs")]),t._v("和"),n("code",[t._v("$listeners")]),t._v(", 并且通过"),n("code",[t._v("defineReactive")]),t._v("将其转换为响应式对象, 开发环境不允许直接对属性进行赋值, 如果赋值则抛警告")])])]),t._v(" "),n("li",[t._v("接下来执行用于定义的"),n("code",[t._v("beforeCreate")]),t._v("生命周期")]),t._v(" "),n("li",[n("code",[t._v("initInjections")]),t._v("和"),n("code",[t._v("initProvide")]),t._v("是一对的")]),t._v(" "),n("li",[n("code",[t._v("initInjections")]),t._v("用于初始化组件的"),n("code",[t._v("inject")]),t._v("全局注入属性\n"),n("ol",[n("li",[t._v("首先是将inject中的所有属性, 并且这些属性要存在于"),n("code",[t._v("vm._provide")]),t._v("(这个表示必须在父组件的provide或者全局的provide中要提供这些属性)中, 提取出来放到result中, 然后遍历这些属性, 将其注入到vm实例上, 并且设置为响应式数据")]),t._v(" "),n("li",[t._v("当前是实例上不存在"),n("code",[t._v("_provided")]),t._v(", 会不停的递归到"),n("code",[t._v("$parent")]),t._v(", 依次往上查询所有的"),n("code",[t._v("provide")]),t._v("属性, 然后在根据inject条件放置到result中")])])]),t._v(" "),n("li",[n("code",[t._v("initProvide")]),t._v("很简单, 就是找到vm.$options.provide对象, 然后将其存储到vm._provide属性上")]),t._v(" "),n("li",[n("code",[t._v("initState")])])]),t._v(" "),n("h2",{attrs:{id:"init源码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#init源码"}},[t._v("#")]),t._v(" _init源码")]),t._v(" "),n("div",{staticClass:"language-ts line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ts"}},[n("code",[t._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("_init")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 这里的vm指向组件实例的vm")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Component "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a uid")]),t._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_uid "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" uid"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 开发环境下的性能检测")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" startTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" endTag\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* istanbul ignore if */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("performance "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" mark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      startTag "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("vue-perf-start:")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_uid"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n      endTag "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("vue-perf-end:")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_uid"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 可以计算出_init函数走了几次")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mark")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a flag to avoid this being observed")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 给vm对象添加标识, 标识vm是vue实例, 后续添加响应式时, 不对vm对象做处理")]),t._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_isVue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// merge options")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 可以理解为将初始化的时候传入的options，都merge到this.$options上面，也就是说，我们可以使用this.$options访问到最初定义的很多东西")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 组件创建的时候执行this._init(options)还是要走这个，然后这里的options._isComponent在组件渲染的时候为true，将会执行initInternalComponent来合并options")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_isComponent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// optimize internal component instantiation")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// since dynamic options merging is pretty slow, and none of the")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// internal component options needs special treatment.")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 局部组件会执行这个逻辑")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initInternalComponent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 在这里，会合并一次$options，将Vue上的options合并到vm的$options实例上")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 全局注册的组件在这里合并, 通过resolveConstructorOptions将Vue合并到vm.$options上")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 全局注册的时候，这个vm就是全局Vue实例,因此此处合并后生成的vm.$options在全局可以访问，他是全局的options")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ! 不管是全局注册，还是局部注册，都会合并Vue上面的options，因此如果我们在Vue的options上面定义的东西，在任何地方都可以使用，但是组件中定义的，就只能merge到Sub.options中，在其他组件就无法访问了")]),t._v("\n      vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mergeOptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * vm.constructor指向Vue构造函数本身")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 因此在初始化的时候，这个参数代表的就是Vue构造函数上面的options")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolveConstructorOptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("constructor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 这个options，就是定义new Vue()的时候传入的配置，如el, created(), render()等")]),t._v("\n        options "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 当前实例")]),t._v("\n        vm\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* istanbul ignore else */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 在生产环境，vm就是_renderProxy")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 开发环境中执行initProxy来初始化_renderProxy")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initProxy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_renderProxy "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// expose real self")]),t._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_self "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 初始化和生命周期相关的一些属性, 以及$parent/$root/$children/$refs")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initLifecycle")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 初始化事件监听")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initEvents")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 初始化render中所使用的h函数")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * $slots/$scopedSlots/_c/createElement/$attrs/$listeners")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initRender")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 在beforeCreate中，vue-router，vuex都混入了一些逻辑")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 执行beforeCreate, 在这个时候，是拿不到组件内部的数据的. 因为到此为止，只初始化了生命周期事件和渲染函数")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'beforeCreate'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 初始化全局注入")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initInjections")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// resolve injections before data/props")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 初始化props和data")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initProvide")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// resolve provide after data/props")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 执行created, 在created中已经可以拿到需要的data, props之类的数据了，因为在这里，已经执行完了provide/inject的初始化，data， props的初始化")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'created'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 也就是说在init的过程中，就会执行beforeCreate和created")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* istanbul ignore if */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("performance "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" mark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("formatComponentName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mark")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("endTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("measure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("vue ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_name"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v(" init")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" startTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" endTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * 判断是否传入了一个DOM对象，也就是挂载的el，如果有，则调用$mount()将el挂载")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// * $mount就是做挂载的方法")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ! 组件创建的时候在$options上并没有el，因此到此为止，不会进去 ")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$mount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br"),n("span",{staticClass:"line-number"},[t._v("45")]),n("br"),n("span",{staticClass:"line-number"},[t._v("46")]),n("br"),n("span",{staticClass:"line-number"},[t._v("47")]),n("br"),n("span",{staticClass:"line-number"},[t._v("48")]),n("br"),n("span",{staticClass:"line-number"},[t._v("49")]),n("br"),n("span",{staticClass:"line-number"},[t._v("50")]),n("br"),n("span",{staticClass:"line-number"},[t._v("51")]),n("br"),n("span",{staticClass:"line-number"},[t._v("52")]),n("br"),n("span",{staticClass:"line-number"},[t._v("53")]),n("br"),n("span",{staticClass:"line-number"},[t._v("54")]),n("br"),n("span",{staticClass:"line-number"},[t._v("55")]),n("br"),n("span",{staticClass:"line-number"},[t._v("56")]),n("br"),n("span",{staticClass:"line-number"},[t._v("57")]),n("br"),n("span",{staticClass:"line-number"},[t._v("58")]),n("br"),n("span",{staticClass:"line-number"},[t._v("59")]),n("br"),n("span",{staticClass:"line-number"},[t._v("60")]),n("br"),n("span",{staticClass:"line-number"},[t._v("61")]),n("br"),n("span",{staticClass:"line-number"},[t._v("62")]),n("br"),n("span",{staticClass:"line-number"},[t._v("63")]),n("br"),n("span",{staticClass:"line-number"},[t._v("64")]),n("br"),n("span",{staticClass:"line-number"},[t._v("65")]),n("br"),n("span",{staticClass:"line-number"},[t._v("66")]),n("br"),n("span",{staticClass:"line-number"},[t._v("67")]),n("br"),n("span",{staticClass:"line-number"},[t._v("68")]),n("br"),n("span",{staticClass:"line-number"},[t._v("69")]),n("br"),n("span",{staticClass:"line-number"},[t._v("70")]),n("br"),n("span",{staticClass:"line-number"},[t._v("71")]),n("br"),n("span",{staticClass:"line-number"},[t._v("72")]),n("br"),n("span",{staticClass:"line-number"},[t._v("73")]),n("br"),n("span",{staticClass:"line-number"},[t._v("74")]),n("br"),n("span",{staticClass:"line-number"},[t._v("75")]),n("br"),n("span",{staticClass:"line-number"},[t._v("76")]),n("br"),n("span",{staticClass:"line-number"},[t._v("77")]),n("br"),n("span",{staticClass:"line-number"},[t._v("78")]),n("br"),n("span",{staticClass:"line-number"},[t._v("79")]),n("br"),n("span",{staticClass:"line-number"},[t._v("80")]),n("br"),n("span",{staticClass:"line-number"},[t._v("81")]),n("br"),n("span",{staticClass:"line-number"},[t._v("82")]),n("br"),n("span",{staticClass:"line-number"},[t._v("83")]),n("br"),n("span",{staticClass:"line-number"},[t._v("84")]),n("br"),n("span",{staticClass:"line-number"},[t._v("85")]),n("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);